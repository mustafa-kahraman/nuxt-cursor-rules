---
description:
globs:
alwaysApply: false
---
# UI Element: Select Menu KurallarÄ± (`<USelectMenu>`)

## ğŸ¯ Kural Tipi YapÄ±landÄ±rmasÄ±

### Birincil Kural Tipi SeÃ§imi
- [ ] Her zaman
- [x] Manuel: AÃ§Ä±lÄ±r menÃ¼den seÃ§im yapÄ±lmasÄ± gerektiÄŸinde baÅŸvurulur
- [ ] Otomatik EklenmiÅŸ
- [ ] Ajan TarafÄ±ndan Ä°stenen

type: manual
description: Nuxt UI `<USelectMenu>` bileÅŸeninin doÄŸru ve tutarlÄ± kullanÄ±mÄ± iÃ§in standartlarÄ± tanÄ±mlar. Arama, Ã§oklu seÃ§im ve nesne seÃ§enekleri gibi Ã¶zellikleri kapsar.
globs: components/**/*.vue, pages/**/*.vue

## ğŸ“‹ Sorumluluklar

### Temel KullanÄ±m
- KullanÄ±cÄ±nÄ±n bir listeden bir veya birden fazla seÃ§eneÄŸi seÃ§mesini saÄŸlamak iÃ§in `<USelectMenu>` kullanÄ±n.
- Her zaman bir `<UFormGroup>` iÃ§ine yerleÅŸtirin (`@form-start.mdc` kuralÄ±na bakÄ±n) etiket, yardÄ±m metni ve hata gÃ¶sterimi iÃ§in.
- `v-model` direktifi ile form state'indeki ilgili alana baÄŸlayÄ±n.

### Prop KullanÄ±mÄ±
- **`items`**: SeÃ§enek listesini iÃ§eren dizi. String dizisi, obje dizisi veya gruplandÄ±rÄ±lmÄ±ÅŸ dizi olabilir.
- **`placeholder`**: HiÃ§bir seÃ§enek seÃ§ili deÄŸilken gÃ¶rÃ¼necek metin.
- **`searchable`**: SeÃ§enekler iÃ§inde arama yapma Ã¶zelliÄŸini aktif eder (`true`/`false`). BÃ¼yÃ¼k listeler iÃ§in Ã¶nerilir.
    - **`search-input`**: Arama alanÄ±nÄ± Ã¶zelleÅŸtirmek iÃ§in `<UInput>` prop'larÄ±nÄ± iÃ§eren obje (`placeholder`, `icon` vb.).
- **`multiple`**: Birden fazla seÃ§enek seÃ§imine izin verir (`true`/`false`). `v-model` bir diziye baÄŸlanmalÄ±dÄ±r.
- **`value-attribute`**: EÄŸer `items` bir obje dizisiyse, `v-model`'e hangi Ã¶zelliÄŸin deÄŸer olarak atanacaÄŸÄ±nÄ± belirtir (Ã¶rn. `id`, `value`). Belirtilmezse tÃ¼m obje atanÄ±r.
- **`option-attribute`**: EÄŸer `items` bir obje dizisiyse, seÃ§enek olarak hangi Ã¶zelliÄŸin gÃ¶sterileceÄŸini belirtir (Ã¶rn. `name`, `label`). VarsayÄ±lan olarak `label` kullanÄ±lÄ±r.
- **`disabled`**: BileÅŸeni etkileÅŸimlere kapatmak iÃ§in.
- **`loading`**: Asenkron olarak seÃ§enek yÃ¼klenirken yÃ¼kleme gÃ¶stergesi gÃ¶stermek iÃ§in.
- **`loading-icon`**: YÃ¼kleme gÃ¶stergesi ikonunu Ã¶zelleÅŸtirmek iÃ§in.
- **`size`**: BileÅŸenin boyutunu ayarlayÄ±n (`xs`, `sm`, `md`, `lg`, `xl`).
- **`color`**: BileÅŸenin rengini ayarlayÄ±n.
- **`variant`**: BileÅŸenin stilini deÄŸiÅŸtirin (`outline`, `none`).
- **`icon`**: Sol tarafa ikon eklemek iÃ§in.
- **`trailing-icon`**: SaÄŸ taraftaki varsayÄ±lan aÃ§Ä±lÄ±r ok ikonunu deÄŸiÅŸtirmek iÃ§in.
- **`selected-icon`**: SeÃ§ili Ã¶ÄŸenin yanÄ±nda gÃ¶sterilecek ikonu deÄŸiÅŸtirmek iÃ§in (varsayÄ±lan: check ikonu).
- **`ui`**: BileÅŸenin stilini Ã¶zelleÅŸtirmek iÃ§in.

### EriÅŸilebilirlik
- `<UFormGroup>` etiketi saÄŸlar.
- Arama Ã¶zelliÄŸi klavye ile gezinmeyi destekler.
- `placeholder` bilgilendirici olmalÄ±dÄ±r.

### Veri Tipleri
- **String Dizisi:** `items` = `['Aktif', 'Pasif']`, `v-model` = `'Aktif'`
- **Obje Dizisi:**
    - `items` = `[{ id: 1, name: 'Admin' }, { id: 2, name: 'Editor' }]`
    - `v-model` = `1` (eÄŸer `value-attribute="id"` ise)
    - `v-model` = `{ id: 1, name: 'Admin' }` (eÄŸer `value-attribute` belirtilmemiÅŸse)
- **Ã‡oklu SeÃ§im:** `v-model` her zaman bir dizi olmalÄ±dÄ±r (`[1, 2]` veya `[{ id: 1, ... }, { id: 2, ... }]`).

## ğŸ§© Anahtar BileÅŸenler
- `<USelectMenu>`: Ana seÃ§im bileÅŸeni.
- `<UFormGroup>`: SarmalayÄ±cÄ± bileÅŸen.

## ğŸ“¦ BaÄŸÄ±mlÄ±lÄ±klar

### Gerekli Paketler
- `@nuxt/ui`

### Gerekli Kurallar
- @form-start.mdc (Formun genel yapÄ±sÄ± ve `<UFormGroup>` kullanÄ±mÄ± iÃ§in)

## âœ… DoÄŸru KullanÄ±m

```vue
<template>
  <UForm :state="state" :schema="schema" @submit="onSubmit" class="space-y-4">
    
    <!-- Temel KullanÄ±m (String Dizisi) -->
    <UFormGroup label="Durum" name="status">
      <USelectMenu 
        v-model="state.status" 
        :items="statusOptions" 
        placeholder="Durum SeÃ§in..."
      />
    </UFormGroup>

    <!-- Obje Dizisi ve Arama -->
    <UFormGroup label="KullanÄ±cÄ±" name="userId">
      <USelectMenu 
        v-model="state.userId" 
        :items="userOptions"
        placeholder="KullanÄ±cÄ± Ara..."
        value-attribute="id" <!-- v-model'e sadece id atasÄ±n -->
        option-attribute="name" <!-- GÃ¶sterilecek Ã¶zellik 'name' olsun -->
        searchable
        :search-input="{ placeholder: 'Ä°sme gÃ¶re ara...' }"
      />
    </UFormGroup>

    <!-- Ã‡oklu SeÃ§im (Basit) -->
    <UFormGroup label="Basit Etiketler" name="simpleTags">
      <USelectMenu 
        v-model="state.simpleTags" 
        :items="tagOptions"
        placeholder="Etiket SeÃ§in..."
        multiple
      />
    </UFormGroup>

    <UButton type="submit">GÃ¶nder</UButton>
  </UForm>
</template>

<script setup lang="ts">
import { reactive } from 'vue';
// ... (schema, onSubmit tanÄ±mlamalarÄ±)

// Ã–rnek SeÃ§enekler
const statusOptions = ['Aktif', 'Pasif', 'Beklemede'];

const userOptions = [
  { id: '1', name: 'Ali Veli', email: 'ali@example.com' },
  { id: '2', name: 'AyÅŸe Kaya', email: 'ayse@example.com' },
  { id: '3', name: 'Mehmet YÄ±lmaz', email: 'mehmet@example.com' },
];

const tagOptions = ['Nuxt', 'Vue', 'UI', 'Frontend', 'Backend'];

// Ã–rnek state
const state = reactive({
    status: undefined,
    userId: undefined,
    simpleTags: [], // Ã‡oklu seÃ§im iÃ§in boÅŸ dizi
    tags: [] // Async Ã¶rnek iÃ§in
})

// Ã–rnek ÅŸema
import { z } from 'zod';
const schema = z.object({
    status: z.string().optional(),
    userId: z.string().optional(), // value-attribute="id" olduÄŸu iÃ§in string
    simpleTags: z.array(z.string()).optional(), // multiple olduÄŸu iÃ§in array
    tags: z.array(z.string()).optional() // Async Ã¶rnek iÃ§in
})

function onSubmit(event: any) {
    console.log('Submitted:', event.data)
}
</script>
```

### Ä°leri DÃ¼zey Ã–rnek: Asenkron Arama, Ã‡oklu SeÃ§im ve Badge GÃ¶sterimi

Bu Ã¶rnek, etiketleri API'den asenkron olarak nasÄ±l getireceÄŸinizi, birden fazla etiket seÃ§imine nasÄ±l izin vereceÄŸinizi ve seÃ§ilen etiketleri `<USelectMenu>` altÄ±nda `<UBadge>` bileÅŸenleri ile nasÄ±l gÃ¶stereceÄŸinizi birleÅŸtirir.

```vue
<template>
  <UForm :state="state" :schema="schema" @submit="onSubmitAdvanced" class="space-y-4">

    <UFormGroup label="GeliÅŸmiÅŸ Etiketler" name="tags">
      <USelectMenu
        v-model="state.tags" 
        :items="filteredTagOptions" <!-- FiltrelenmiÅŸ/YÃ¼klenmiÅŸ etiketler -->
        multiple
        placeholder="Etiket Ara veya SeÃ§..."
        searchable
        :search-attributes="['name']" <!-- Obje dizisinde aranacak alan -->
        option-attribute="name" <!-- GÃ¶sterilecek alan -->
        value-attribute="id" <!-- v-model'e id'yi ata -->
        :loading="isLoading"
        @search="handleSearch" <!-- Arama yazÄ±ldÄ±ÄŸÄ±nda tetiklenir -->
      >
        <!-- SeÃ§eneklerin nasÄ±l gÃ¶rÃ¼neceÄŸini Ã¶zelleÅŸtirme (opsiyonel) -->
        <template #option="{ option: tag }">
          <span>{{ tag.name }}</span>
        </template>

         <!-- Arama sonucu bulunamazsa (opsiyonel) -->
         <template #option-empty="{ query }">
            <q>{{ query }}</q> bulunamadÄ±.
         </template>
      </USelectMenu>
    </UFormGroup>

    <!-- SeÃ§ilen Etiketleri Badge Olarak GÃ¶sterme -->
    <div v-if="state.tags?.length" class="flex flex-wrap gap-2 mt-2">
       <UBadge
         v-for="tagId in state.tags"
         :key="tagId"
         color="primary"
         variant="soft"
         size="lg"
         class="flex items-center gap-1"
       >
         {{ getTagNameById(tagId) }} <!-- SeÃ§ili ID'ye karÅŸÄ±lÄ±k gelen ismi bul -->
         <UButton
           icon="i-heroicons-x-mark-20-solid"
           color="primary"
           variant="link"
           size="2xs"
           :padded="false"
           @click="removeTag(tagId)"
         />
       </UBadge>
    </div>

    <UButton type="submit">GeliÅŸmiÅŸ GÃ¶nder</UButton>
  </UForm>
</template>

<script setup lang="ts">
import { ref, reactive, computed, onMounted } from 'vue';
import { z } from 'zod';
import type { FormSubmitEvent } from '#ui/types';

// --- ArayÃ¼zler (Normalde @types-schema-models'dan gelir) ---
interface ITag {
  id: string;
  name: string;
}
interface IFormData {
    status?: string;
    userId?: string;
    simpleTags?: string[];
    tags?: string[]; // v-model ID dizisi tutacak
}
// --- --- ---

// --- Mock API Fonksiyonu (GerÃ§ek uygulamada $fetch kullanÄ±lÄ±r) ---
const allTags: ITag[] = [
  { id: '1', name: 'Nuxt' }, { id: '2', name: 'Vue' }, { id: '3', name: 'TypeScript' },
  { id: '4', name: 'TailwindCSS' }, { id: '5', name: 'Nuxt UI' }, { id: '6', name: 'VeeValidate' },
  { id: '7', name: 'Zod' }, { id: '8', name: 'Pinia' },
];

async function fetchTags(query?: string): Promise<ITag[]> {
  console.log("API'ye istek gÃ¶nderiliyor, arama:", query);
  await new Promise(resolve => setTimeout(resolve, 500)); // Network gecikmesini simÃ¼le et
  if (!query) {
    return allTags.slice(0, 10); // BaÅŸlangÄ±Ã§ta veya boÅŸ aramada ilk 10'u gÃ¶ster
  }
  const lowerQuery = query.toLowerCase();
  return allTags.filter(tag => tag.name.toLowerCase().includes(lowerQuery));
}
// --- --- ---

// --- State ve Åema --- 
// Ã–nceki Ã¶rnekten state ve schema'yÄ± alÄ±yoruz
const state = reactive<IFormData>({
    status: undefined,
    userId: undefined,
    simpleTags: [],
    tags: [] // BaÅŸlangÄ±Ã§ta boÅŸ dizi
});

const schema = z.object({
    status: z.string().optional(),
    userId: z.string().optional(),
    simpleTags: z.array(z.string()).optional(),
    tags: z.array(z.string()).optional()
});
// --- --- --- 

const isLoading = ref(false);
const fetchedTagOptions = ref<ITag[]>([]); // API'den gelen tÃ¼m seÃ§enekler

// Arama veya ilk yÃ¼kleme fonksiyonu
async function handleSearch(query?: string) {
  isLoading.value = true;
  // Mevcut seÃ§ili etiketlerin objelerini koruyalÄ±m ki isimleri gÃ¶sterebilelim
  const currentlySelectedFullTags = allTags.filter(tag => state.tags?.includes(tag.id));
  const searchResults = await fetchTags(query);
  // API'den dÃ¶nen sonuÃ§larla mevcut seÃ§ilileri birleÅŸtir (duplicate olmadan)
  const combinedOptions = [...currentlySelectedFullTags];
  searchResults.forEach(result => {
      if (!combinedOptions.some(existing => existing.id === result.id)) {
          combinedOptions.push(result);
      }
  });
  fetchedTagOptions.value = combinedOptions;
  isLoading.value = false;
}

// Component yÃ¼klendiÄŸinde baÅŸlangÄ±Ã§ etiketlerini getir
onMounted(async () => {
    await handleSearch();
});

// Badge'de ismi gÃ¶stermek iÃ§in helper
function getTagNameById(id: string): string {
    const tag = fetchedTagOptions.value.find(t => t.id === id) ?? allTags.find(t => t.id === id); // Ã–nce fetch edilenlerde ara
    return tag?.name ?? id; 
}

// Badge'den etiket kaldÄ±rma fonksiyonu
function removeTag(tagIdToRemove: string) {
    state.tags = state.tags?.filter(id => id !== tagIdToRemove);
}

function onSubmitAdvanced(event: FormSubmitEvent<any>) {
    console.log('Submitted Advanced Tags (IDs):', event.data.tags);
}

// Ã–nceki onSubmit fonksiyonu da burada olabilir
function onSubmit(event: any) {
    console.log('Submitted:', event.data)
}

</script>
```

## âŒ YanlÄ±ÅŸ KullanÄ±m
- `<USelectMenu>`'yÃ¼ `<UFormGroup>` olmadan kullanmak.
- `multiple` prop'u varken `v-model`'i dizi olmayan bir deÄŸere baÄŸlamak.
- Obje dizisi kullanÄ±rken `value-attribute` veya `option-attribute` prop'larÄ±nÄ± ihtiyaca gÃ¶re ayarlamamak (istenmeyen deÄŸerlerin veya gÃ¶sterimlerin oluÅŸmasÄ±na neden olabilir).
- Ã‡ok fazla seÃ§enek varken `searchable` prop'unu kullanmamak.

## ğŸ” Kontrol Listesi
- [ ] `<USelectMenu>`, `<UFormGroup>` iÃ§inde mi kullanÄ±lÄ±yor?
- [ ] `v-model` ile state'e doÄŸru baÄŸlanmÄ±ÅŸ mÄ±?
- [ ] `items` prop'u doÄŸru formatta saÄŸlanmÄ±ÅŸ mÄ±?
- [ ] `multiple` aktifse `v-model` dizi mi?
- [ ] Obje dizisi kullanÄ±lÄ±yorsa `value-attribute` ve `option-attribute` doÄŸru ayarlanmÄ±ÅŸ mÄ±?
- [ ] Ã‡ok sayÄ±da seÃ§enek varsa `searchable` kullanÄ±lÄ±yor mu?
- [ ] `placeholder` metninin doÄŸru gÃ¶sterildiÄŸini test edin.

## ğŸ“ Kural Ä°Ã§eriÄŸi YÃ¶nergeleri
- Temel kullanÄ±mÄ± ve `<UFormGroup>` ile entegrasyonu aÃ§Ä±klayÄ±n.
- String ve obje dizileri ile kullanÄ±m farklarÄ±nÄ± vurgulayÄ±n (`value-attribute`, `option-attribute`).
- `searchable` ve `multiple` prop'larÄ±nÄ±n kullanÄ±mÄ±nÄ± Ã¶rnekleyin.
- `v-model`'in veri tipinin `multiple` ve `value-attribute`'e gÃ¶re nasÄ±l deÄŸiÅŸtiÄŸini belirtin.

## ğŸ”„ Kural BakÄ±mÄ±
- Nuxt UI gÃ¼ncellemeleriyle gelen yeni `<USelectMenu>` prop'larÄ±nÄ± veya Ã¶zelliklerini (Ã¶rn. async search yetenekleri) ekleyin.

## ğŸ§ª Testler
- Component testleri ile:
  - [ ] SeÃ§eneklerin doÄŸru listelendiÄŸini test edin.
  - [ ] Bir seÃ§enek seÃ§ildiÄŸinde `v-model`'in doÄŸru gÃ¼ncellendiÄŸini test edin (string, obje veya id durumlarÄ± iÃ§in ayrÄ± ayrÄ±).
  - [ ] `multiple` modda birden fazla seÃ§im yapÄ±ldÄ±ÄŸÄ±nda `v-model` dizisinin doÄŸru gÃ¼ncellendiÄŸini test edin.
  - [ ] `searchable` aktifken arama yapÄ±ldÄ±ÄŸÄ±nda listenin filtrelendiÄŸini test edin.
  - [ ] `placeholder` metninin doÄŸru gÃ¶sterildiÄŸini test edin.
  - [ ] `disabled` prop'unun etkileÅŸimi engellediÄŸini test edin.

## ğŸ’¡ Ä°puÃ§larÄ±
- Ã‡ok fazla seÃ§eneÄŸi (Ã¶rn. >100) API'den asenkron olarak yÃ¼klemek iÃ§in `searchable` prop'u ile birlikte `async function` kullanmayÄ± ve `loading` state'ini yÃ¶netmeyi dÃ¼ÅŸÃ¼nÃ¼n. Bu durumda `items` dinamik olarak gÃ¼ncellenir.
- SeÃ§eneklerin gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ tamamen Ã¶zelleÅŸtirmek iÃ§in `#option`, `#option-empty`, `#option-create` gibi slotlarÄ± kullanabilirsiniz.
